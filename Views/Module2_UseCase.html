<!-- Module 2: ユースケース選定 -->
<div class="max-w-[1440px] mx-auto w-full px-6 pt-6 pb-32">

  <!-- Header -->
  <div class="flex flex-col gap-1 bg-white p-6 rounded-lg shadow-card border border-slate-200 mb-6">
    <div class="flex items-center gap-3 mb-1">
      <span class="px-2 py-0.5 rounded bg-blue-50 text-primary text-[11px] font-bold uppercase tracking-wide border border-blue-100">Step 2</span>
      <h1 class="text-2xl font-bold text-slate-800 tracking-tight">ユースケース選定</h1>
    </div>
    <p class="text-slate-500 text-sm leading-relaxed max-w-3xl">
      候補のユースケースをスコアリングし、ビジネスインパクトと実現可能性に基づいて上位1〜2件を選定します。
    </p>
  </div>

  <!-- Use Case Table -->
  <div class="bg-white rounded-lg shadow-card border border-slate-200 overflow-hidden">
    <div class="overflow-x-auto">
      <table class="w-full min-w-[900px]">
        <thead>
          <tr class="bg-slate-50 border-b border-slate-200">
            <th class="px-6 py-3 text-left text-[11px] font-bold text-slate-500 uppercase tracking-wider w-[28%]">
              Candidate Use Case
            </th>
            <th class="px-4 py-3 text-left w-[15%]">
              <div class="flex flex-col">
                <span class="text-xs font-bold text-slate-700">インパクト</span>
                <span class="text-[10px] text-slate-400 font-normal">Impact (1-5)</span>
              </div>
            </th>
            <th class="px-4 py-3 text-left w-[15%]">
              <div class="flex flex-col">
                <span class="text-xs font-bold text-slate-700">実現性(90日)</span>
                <span class="text-[10px] text-slate-400 font-normal">Feasibility (1-5)</span>
              </div>
            </th>
            <th class="px-4 py-3 text-left w-[15%]">
              <div class="flex flex-col">
                <span class="text-xs font-bold text-slate-700">能力構築</span>
                <span class="text-[10px] text-slate-400 font-normal">Capability (1-5)</span>
              </div>
            </th>
            <th class="px-4 py-3 text-center text-[11px] font-bold text-slate-500 uppercase tracking-wider w-[10%] border-l border-slate-100">
              Total
            </th>
            <th class="px-6 py-3 text-center text-[11px] font-bold text-slate-500 uppercase tracking-wider w-[9%] bg-blue-50/30">
              Select
            </th>
          </tr>
        </thead>
        <tbody class="divide-y divide-slate-100" id="usecase-table-body">
          <!-- Use case rows will be rendered here -->
          <tr class="hover:bg-slate-50 transition-colors group">
            <td class="px-6 py-4">
              <div class="flex items-start gap-3">
                <div class="size-8 rounded bg-primary/10 text-primary flex items-center justify-center shrink-0 mt-0.5">
                  <span class="material-symbols-outlined text-lg">support_agent</span>
                </div>
                <div>
                  <input type="text" data-field="usecase.0.title" class="font-bold text-slate-800 text-sm bg-transparent border-b border-transparent focus:border-primary outline-none w-full" value="AI Customer Support" />
                  <input type="text" data-field="usecase.0.desc" class="text-xs text-slate-500 mt-0.5 bg-transparent border-b border-transparent focus:border-primary outline-none w-full" value="Automated ticket resolution" />
                </div>
              </div>
            </td>
            <td class="px-4 py-4 align-middle">
              <div class="flex items-center gap-3">
                <span class="text-sm font-semibold text-slate-700 w-3" data-score="usecase.0.impact">4</span>
                <input type="range" min="1" max="5" value="4" data-field="usecase.0.impact" class="w-full" onchange="this.previousElementSibling.textContent = this.value" />
              </div>
            </td>
            <td class="px-4 py-4 align-middle">
              <div class="flex items-center gap-3">
                <span class="text-sm font-semibold text-slate-700 w-3" data-score="usecase.0.feasibility">3</span>
                <input type="range" min="1" max="5" value="3" data-field="usecase.0.feasibility" class="w-full" onchange="this.previousElementSibling.textContent = this.value" />
              </div>
            </td>
            <td class="px-4 py-4 align-middle">
              <div class="flex items-center gap-3">
                <span class="text-sm font-semibold text-slate-700 w-3" data-score="usecase.0.capability">5</span>
                <input type="range" min="1" max="5" value="5" data-field="usecase.0.capability" class="w-full" onchange="this.previousElementSibling.textContent = this.value" />
              </div>
            </td>
            <td class="px-4 py-4 text-center border-l border-slate-100 bg-slate-50/30">
              <span class="text-lg font-black text-slate-800" data-total="usecase.0">12</span>
            </td>
            <td class="px-6 py-4 text-center bg-blue-50/30 border-l border-blue-100">
              <input type="checkbox" data-field="usecase.0.selected" class="size-5 rounded border-slate-300 text-primary focus:ring-primary/20 cursor-pointer transition-all" />
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Criteria Guide Sidebar (Optional) -->
  <div class="mt-6 bg-white rounded-lg shadow-card border border-slate-200 p-5">
    <div class="flex items-center gap-2 mb-4">
      <span class="material-symbols-outlined text-primary">menu_book</span>
      <h3 class="font-bold text-slate-800 text-sm">評価基準ガイド</h3>
    </div>
    <div class="grid md:grid-cols-3 gap-4 text-sm">
      <div>
        <h4 class="font-bold text-xs text-slate-800 uppercase tracking-wide mb-1">1. インパクト</h4>
        <p class="text-slate-600">売上拡大やコスト削減のポテンシャル。ビジネスにどれだけの価値をもたらすかを1-5で評価します。</p>
      </div>
      <div>
        <h4 class="font-bold text-xs text-slate-800 uppercase tracking-wide mb-1">2. 90日実現性</h4>
        <p class="text-slate-600">技術的・組織的な準備状況。3ヶ月以内に成果を出せる現実性があるかを評価します。</p>
      </div>
      <div>
        <h4 class="font-bold text-xs text-slate-800 uppercase tracking-wide mb-1">3. 能力構築</h4>
        <p class="text-slate-600">将来のスキル獲得への貢献度。このプロジェクトを通じてチームが成長できるかを評価します。</p>
      </div>
    </div>
  </div>
</div>

<!-- Action Bar -->
<div class="fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 shadow-[0_-4px_20px_-5px_rgba(0,0,0,0.1)] z-40 p-4 px-6">
  <div class="max-w-[1440px] mx-auto flex justify-between items-center">
    <div class="flex items-center gap-3 bg-slate-50 px-3 py-1.5 rounded-full border border-slate-200">
      <span class="text-sm font-medium text-slate-600">選択済み: <span class="text-slate-900 font-bold" id="selected-count">0</span> / 2</span>
    </div>
    <div class="flex items-center gap-4">
      <button onclick="App.saveCurrentModule()" class="bg-white hover:bg-slate-50 text-slate-700 font-semibold py-2.5 px-6 rounded-md border border-slate-300 transition-all text-sm">
        保存
      </button>
      <button onclick="App.markModuleComplete()" class="bg-primary hover:bg-primary-dark text-white font-semibold py-2.5 px-6 rounded-md shadow-sm transition-all flex items-center gap-2 text-sm">
        <span class="material-symbols-outlined text-[18px]">calendar_add_on</span>
        完了して次へ
      </button>
    </div>
  </div>
</div>

<script>
// Update selected count
function updateSelectedCount() {
  const selected = document.querySelectorAll('input[type="checkbox"][data-field*="selected"]:checked').length;
  const countEl = document.getElementById('selected-count');
  if (countEl) countEl.textContent = selected;
}

// Auto-calculate totals
function updateTotals() {
  document.querySelectorAll('[data-total]').forEach(el => {
    const index = el.getAttribute('data-total').split('.')[1];
    const impact = parseInt(document.querySelector(`[data-field="usecase.${index}.impact"]`)?.value || 0);
    const feasibility = parseInt(document.querySelector(`[data-field="usecase.${index}.feasibility"]`)?.value || 0);
    const capability = parseInt(document.querySelector(`[data-field="usecase.${index}.capability"]`)?.value || 0);
    el.textContent = impact + feasibility + capability;
  });
}

// Setup listeners
document.querySelectorAll('input[type="range"]').forEach(el => {
  el.addEventListener('change', updateTotals);
});

document.querySelectorAll('input[type="checkbox"]').forEach(el => {
  el.addEventListener('change', updateSelectedCount);
});

// Initial update
updateTotals();
updateSelectedCount();
</script>
